<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Worker Dashboard - Wrifto">
    <meta name="theme-color" content="#2563eb">
    <title>Worker Dashboard — Wrifto</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">
                    <div class="logo-icon">
                        <img src="images/wrifto logo.jpeg" alt="Wrifto">
                    </div>
                </a>
                <nav class="nav desktop-nav">
                    <a href="index.html" class="nav-link">Home</a>
                    <a href="browse.html" class="nav-link">Browse</a>
                    <a href="worker-register.html" class="nav-link">Update Profile</a>
                </nav>
                <div class="header-actions">
                    <button class="btn-secondary" onclick="logout(); window.location.href='auth.html'">Sign Out</button>
                </div>
            </div>
        </div>
    </header>

    <main class="dashboard-page">
        <div class="container">
            <div class="page-header">
                <h1 class="page-title">Hello, <span id="workerName"></span></h1>
                <p class="page-subtitle" id="workerInfo"></p>
            </div>

            <div class="dashboard-section">
                <h2 class="section-title">Customer Requests</h2>
                <div class="requests-list" id="requestsList">
                    <p class="empty-state">No requests yet. Complete KYC and get listed to receive customer contacts.</p>
                </div>
            </div>
        </div>
    </main>

    <script src="auth.js"></script>
    <script src="data.js"></script>
    <script>
        const user = getCurrentUser();
        if (!user || user.type !== 'worker') {
            window.location.href = 'auth.html';
        }
        document.getElementById('workerName').textContent = user.name || 'Worker';
        const worker = getWorkerDB(user.id);
        if (worker) {
            const cat = (typeof categories !== 'undefined' && categories.find(c => c.id === worker.category))?.name || worker.category;
            document.getElementById('workerInfo').textContent = cat ? `${cat} • ₹${worker.hourlyRate}/hr` : 'Complete your profile';
            const reqs = getContactRequests()[worker.id] || worker.requests || [];
            const list = document.getElementById('requestsList');
            if (reqs.length) {
                list.innerHTML = reqs.slice().reverse().map(r => {
                    const d = new Date(r.date);
                    return `<div class="contact-item">
                        <div><strong>${r.customerName || 'Customer'}</strong> wants to connect</div>
                        <div class="text-muted">${d.toLocaleDateString()}</div>
                    </div>`;
                }).join('');
            }
        }
    </script>
</body>
</html>
