<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="My Dashboard - Wrifto">
    <meta name="theme-color" content="#2563eb">
    <title>My Dashboard â€” Wrifto</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">
                    <div class="logo-icon">W</div>
                    <span class="logo-text">Wrifto</span>
                </a>
                <nav class="nav desktop-nav">
                    <a href="index.html" class="nav-link">Home</a>
                    <a href="browse.html" class="nav-link">Browse Workers</a>
                    <a href="subscriptions.html" class="nav-link">Buy Credits</a>
                </nav>
                <div class="header-actions">
                    <a href="subscriptions.html" class="btn-primary" id="creditsBtn">Credits: 0</a>
                    <button class="btn-secondary" onclick="logout(); window.location.href='auth.html'">Sign Out</button>
                </div>
            </div>
        </div>
    </header>

    <main class="dashboard-page">
        <div class="container">
            <div class="page-header">
                <h1 class="page-title">Welcome, <span id="userName"></span></h1>
                <p class="page-subtitle">Manage your credits and contacts</p>
            </div>

            <div class="dashboard-grid">
                <div class="dashboard-card highlight">
                    <h3 class="card-title">Credits Balance</h3>
                    <p class="card-value" id="creditsBalance">0</p>
                    <p class="card-hint">5 credits = 1 contact</p>
                    <a href="subscriptions.html" class="btn-primary">Buy More Credits</a>
                </div>
                <div class="dashboard-card">
                    <h3 class="card-title">Total Contacts</h3>
                    <p class="card-value" id="contactsCount">0</p>
                    <p class="card-hint">Workers you've contacted</p>
                </div>
            </div>

            <div class="dashboard-section">
                <h2 class="section-title">Recent Contacts</h2>
                <div class="contacts-list" id="contactsList">
                    <p class="empty-state">No contacts yet. <a href="browse.html">Browse workers</a> and use credits to contact them.</p>
                </div>
            </div>
        </div>
    </main>

    <script src="auth.js"></script>
    <script>
        const user = getCurrentUser();
        if (!user || user.type !== 'customer') {
            window.location.href = 'auth.html';
        }
        document.getElementById('userName').textContent = user.name || 'Customer';
        const customer = getCustomer(user.id);
        const credits = (customer && customer.credits) ? customer.credits : 0;
        const contacts = getCustomerContacts(user.id);
        document.getElementById('creditsBalance').textContent = credits;
        document.getElementById('contactsCount').textContent = contacts.length;
        document.getElementById('creditsBtn').textContent = 'Credits: ' + credits;

        const list = document.getElementById('contactsList');
        if (contacts.length) {
            list.innerHTML = contacts.slice().reverse().map(c => {
                const d = new Date(c.date);
                return `<div class="contact-item">
                    <div><strong>${c.workerName || 'Worker'}</strong></div>
                    <div class="text-muted">${d.toLocaleDateString()}</div>
                </div>`;
            }).join('');
        }
    </script>
</body>
</html>
